<div>
    <!--<p id="demo" style="height: 30px; width: 100%;"></p>-->
    <div id="map" style="height: 100%; width: 100%;"></div>

    <div id="createRally">

        <form action="#" class="was-validated">
            <div class="form-group">
                <label for="rallyName">Rally</label>
                <input type="text" class="form-control" id="rally" placeholder="Rally name" required>
            </div>
            <div class="form-group">
                <label for="description">Description</label>
                <input type="text" class="form-control" id="description" placeholder="Description" required>
            </div>
            <div class="form-group">
                <label for="place">Place</label>
                <input type="text" class="form-control" id="place" placeholder="Where the rally is ?" required>
            </div>
            <div class="form-group">
                <label for="date">Date</label>
                <input type="date" class="form-control" id="date" placeholder="When ?" required>
            </div>
            <div class="form-group">
                <label for="time">Hour</label>
                <input type="time" class="form-control" id="time" placeholder="What time ?" required>
            </div>
            <div class="form-group">
                <label for="radio"></label>
                <input type="number" class="form-control" id="radio" placeholder="Roughly rally's radio in meters" required>
            </div>
            <div class="form-group">
                <label for="email"></label>
                <input type="email" class="form-control" id="email" placeholder="Confirm email" required>
            </div>
            <div class="form-group">
                <label for="password"></label>
                <input type="password" class="form-control" id="password" placeholder="Confirm password" required>
            </div>
            <!--valider : vérifie si un rassemblement prévu est proche (en date et lieu)-->
            <span id="message" style="color:red"></span>
            <br>
            <button class="button" onclick="createRally()">Create</button>
            <span id="message" style="color:red"></span>
        </form>

    </div>

</div>

<script type="text/javascript" src="./js/map.js"></script>

<script>

                function initMap() {
                    
                    var marker;
                    var map = new google.maps.Map(document.getElementById("map"), {
                        zoom: 17,
                        scaleControl: false,
                        fullscreenControl: false,
                        zoomControl: false,
                        center: {lat: 45.78165420692724,lng: 4.872048616873495},
                        mapTypeControl: true,
                        mapTypeControlOptions: {
                            style: google.maps.MapTypeControlStyle.HORIZONTAL_BAR,
                            mapTypeIds: ['roadmap', 'satellite'],
                            position: google.maps.ControlPosition.LEFT_BOTTOM
                        }});
                    
                    marker = new google.maps.Marker({
                        position: {lat: 45.78165420692724,lng: 4.872048616873495},
                        map: map,
                        icon: {url: "./icons/man-red-user.png"}
                    });

                    var controlDiv = document.createElement('div');

                    // Set CSS for the control border
                    var controlUI = document.createElement('div');
                    controlUI.style.backgroundColor = 'red';
                    controlUI.style.border = '2px solid #fff';
                    controlUI.style.cursor = 'pointer';
                    controlUI.style.marginTop = '22px';
                    controlUI.style.marginLeft = '22px';
                    controlUI.style.textAlign = 'center';
                    controlUI.title = 'Click to recenter the map';
                    controlDiv.appendChild(controlUI);
                    // Set CSS for the control interior
                    var controlText = document.createElement('div');
                    controlText.style.color = 'rgb(255,255,255)';
                    controlText.style.fontFamily = 'Roboto,Arial,sans-serif';
                    controlText.style.fontSize = '16px';
                    controlText.style.lineHeight = '38px';
                    controlText.style.paddingLeft = '5px';
                    controlText.style.paddingRight = '5px';
                    controlText.innerHTML = 'New Rally';
                    controlUI.appendChild(controlText);
                    controlUI.addEventListener('click', function () {
                        newRally();
                    });
                    controlDiv.index = 1;
                    map.controls[google.maps.ControlPosition.TOP_LEFT].push(controlDiv);
                    
                    //infoWindow = new google.maps.InfoWindow;
                    /*function handleLocationError(browserHasGeolocation, infoWindow, pos) {
                        infoWindow.setPosition(pos);
                        infoWindow.setContent(browserHasGeolocation ?
                                'Error: The Geolocation service failed.' :
                                'Error: Your browser doesn\'t support geolocation.');
                        infoWindow.open(map);
                    }*/
                    // handleLocationError(false, infoWindow, map.getCenter());
                    //handleLocationError(true, infoWindow, map.getCenter());
                    var myLatlng;
                    var pos;
                    if (navigator.geolocation) {
                            navigator.geolocation.getCurrentPosition(function (position) {
                                pos = { lat: position.coords.latitude,
                                lng: position.coords.longitude};
                                
                                myLatlng = new google.maps.LatLng(pos.lat,pos.lng);
                                marker.setPosition(myLatlng);
                                console.log("je suis appelle");
                                
                            }, function () {
                                Console.log("The geolocation service failed");
                            });
                        } else {
                            Console.log("Browser doesn't support geolocation");
                        }
                    }
        
                    /*
                    window.setInterval(function () {
                        , 5000);*/
                }
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCyfR4HiGWGxQ7CiwH4VGEh0qjaL6LYv1M&callback=initMap"></script>



